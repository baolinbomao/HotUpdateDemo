{"version":3,"sources":["../../../../assets/Script/assets/Script/HotUpdate.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../assets/Script","sourcesContent":["/**\n * 热更新文件\n */\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport class HotUpdate extends cc.Component {\n    //更新主文件夹路径\n    private _storagePath: string = '';\n    //自定义的manifest\n    private custom_Manifest_Path: string = ''\n    //jsb的资源管理器实体\n    private _am: any;\n    // 是否正在检查更新或者正在更新\n    private isUpdating: boolean = false;\n    // 检查更新的监听 \n    private _checkListener: any;\n    // 正式更新的监听 \n    private _updateListener: any;\n\n    onLoad() {\n        this.createAM();\n        this.initManifest();\n    }\n\n    //创建热更新管理器\n    private createAM() {\n        //如果不是Native，则不需要热更新\n        if (!cc.sys.isNative) {\n            return;\n        }\n\n        //设置热更新的临时文件夹\n        this._storagePath = ((jsb.fileUtils ? jsb.fileUtils.getWritablePath() : '/') + 'hotUpdate/');\n        if (!jsb.fileUtils.isDirectoryExist(this._storagePath)) {\n            console.log(`${this._storagePath} directory doesn't exist`);\n            jsb.fileUtils.createDirectory(this._storagePath);\n            console.log('this._storagePath:', this._storagePath)\n        } else {\n            cc.log(`storage path for remote asset: ${this._storagePath}`);\n        }\n\n        //版本比较函数；\n        // versionA>versionB代表versionA版本高，\n        // versionA<versionB代表versionA版本低，\n        // versionA=versionB代表versionA版本相同，\n        const versionCompare = (versionA, versionB) => {\n            console.log(\"version A is \" + versionA + ', version B is ' + versionB);\n            let vA = versionA.split('.');\n            let vB = versionB.split('.');\n\n            for (let i = 0; i < vA.length; i += 1) {\n                let a = parseInt(vA[i]);\n                let b = parseInt(vB[i] || 0);\n                if (a === b) {\n                    continue;\n                }\n                else {\n                    return a - b;\n                }\n            }\n\n            if (vB.length > vA.length) {\n                return -1;\n            }\n            else {\n                return 0;\n            }\n        };\n\n        //初始化一个空的manifest url\n        this._am = new jsb.AssetsManager('', this._storagePath, versionCompare);\n\n        if (!cc.sys.ENABLE_GC_FOR_NATIVE_OBJECTS) {\n            // 由于下载过程是异步的，需要增加_am的索引数以保证它不会被Cocos2d-x的内存管理释放掉\n            // 继承于Ref计数器，防止被自动回收\n            this._am.retain();\n        }\n\n        //设置文件下载完成后的校验\n        this._am.setVerifyCallback((path, asset) => {\n            // When asset is 压缩, we don't need to check its md5, because zip file have been deleted.\n            let compressed = asset.compressed;\n            // Retrieve the correct md5 value.\n            let correctedMD5 = asset.md5;\n            // asset.path is 相对路径 and path is 绝对路径.\n            let relativePath = asset.path;\n            // The size of asset file, but this value could be 不存在.\n            let size = asset.size;\n            if (compressed) {\n                console.log(\"Verification passed : \" + relativePath);\n                return true;\n            } else {\n                console.log(\"Verification passed : \" + relativePath + ' (' + correctedMD5 + ')');\n                return true;\n            }\n        })\n\n        console.log('Hot update is ready, please check or directly update.');\n\n        if (cc.sys.os === cc.sys.OS_ANDROID) {\n            // Some Android device may slow down the download process when concurrent tasks is too much.\n            // The value may not be accurate, please do more test and find what's most suitable for your game.\n            // 控制下载并发数量\n            this._am.setMaxConcurrentTask(10);\n            console.log(\"Max concurrent tasks count have been limited to 10\");\n        }\n\n        // this.panel.fileProgress.progress = 0;\n        // this.panel.byteProgress.progress = 0; \n    }\n\n    // 检查热更新\n    private initManifest() {\n        //官网写法\n        // if(this._am.getState() === jsb.AssetsManager.State.UNINITED) {\n        //     let manifest = new jsb.Manifest(this.custom_Manifest_Path, this._storagePath);\n        //     this._am.loadLocalManifest(manifest, this._storagePath);\n        // }\n\n        //自定义写法 \n        //project.manifest是自己定义的，需要自己做\n        if(!this.custom_Manifest_Path){\n            this.custom_Manifest_Path = 'res/raw-assets/resources/project.manifest';\n        }\n        //如果有缓存的cache，则动态修改cache的文件内容\n        if (jsb.fileUtils.isDirectoryExist(this._storagePath)) {\n            console.log(\"project.manifest存在，直接从文件读取\");\n            console.log('this._storagePath:', this.custom_Manifest_Path)\n            let jsonStr = jsb.fileUtils.getStringFromFile(this.custom_Manifest_Path);\n            console.log(\"json:\", jsonStr)\n            let json = JSON.parse(jsonStr);\n            this.initJson(json)\n            jsb.fileUtils.writeStringToFile(JSON.stringify(json), this.custom_Manifest_Path);\n        }\n\n        cc.loader.loadRes(\"project\", this.loadManifest.bind(this));\n        // this.progress.progress = 0;\n        // this.label.string = \"正在连接服务器\";\n    }\n \n    //修改project.manifest中的内容\n    private initJson(json: any) {\n        console.log(\"原始packageUrl=\" + json.packageUrl);\n        console.log(\"原始remoteManifestUrl=\" + json.remoteManifestUrl);\n        console.log(\"原始remoteVersionUrl=\" + json.remoteVersionUrl);\n        console.log(\"原始version=\" + json.version);\n\n\n        //修改热更新的地址\n        cc.log(\"修改packageUrl=\");\n        json.packageUrl = 'http://172.16.0.37:8000/';\n\n        cc.log(\"修改remoteManifestUrl=\");\n        json.remoteManifestUrl = 'http://172.16.0.37:8000/project.manifest';\n\n        cc.log(\"修改remoteVersionUrl=\");\n        json.remoteVersionUrl = 'http://172.16.0.37:8000/version.manifest';\n\n        cc.log(\"远程的version=\");\n    }\n\n    //加载manifest\n    private loadManifest(error, jsonString) {\n        // private loadManifest( jsonString) {\n        if (error) {\n            console.log('error:', error)\n            return;\n        }\n\n        if (jsonString.length > 0) {\n            //获取上次热更新以后的记录\n            const json = JSON.parse(jsonString);\n            this.initJson(json);\n            jsonString = JSON.stringify(json);\n            const manifest = new jsb.Manifest(jsonString, this._storagePath);\n            this._am.loadLocalManifest(manifest, this._storagePath);\n            this.checkUpdate();\n        }\n    }\n\n    //检查更新\n    private checkUpdate() {\n        if(this.isUpdating) {\n            console.log('正在更新或者正在检查更新！');\n            return;\n        }\n\n        // 如果热更新管理器没有初始化，则重新初始化\n        if(this._am.getState() === jsb.AssetsManager.State.UNINITED){\n            console.log('重新加载local manifest!');\n            this.initManifest();\n        }\n\n        //检查local manifest加载是否成功\n        if(!this._am.getLocalManifest() || !this._am.getLocalManifest().isLoaded()){\n            console.log('加载local manifest失败!');\n            return;\n        }\n\n        this.isUpdating = true;\n        //创建并添加更新的监听\n        this._checkListener = new jsb.EventListenerAssetsManager(this._am, this.checkCB.bind(this));\n        cc.eventManager.addListener(this._checkListener, 1);\n\n        // 启动更新检查\n        this._am.checkUpdate();\n    }\n\n    //对检查更新的结果进行处理\n    private checkCB(event) {\n        console.log('checkCBCode: ' + event.getEventCode());\n        console.log('返回一个code')\n        const code = event.getEventCode();\n        //是否需要重新检查更新\n        let needRetryCheck: boolean = false;\n        //是否需要更新\n        let needUpdate: boolean = false;\n\n        switch(code){\n            case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:\n                console.log('local Manifest未发现, 更新停止.');\n            break;\n\n            case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:\n            console.log('下载Manifest失败, 更新停止.');\n                needRetryCheck = true;\n            break;\n\n            case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:\n            console.log('解析Manifest失败, 更新停止.');\n                needRetryCheck = true;\n            break;\n\n            case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:\n            console.log('当前版本已是最新, 更新停止.');\n            break;\n\n            case jsb.EventAssetsManager.NEW_VERSION_FOUND:\n            console.log('发现新版本，请开始更新.');\n                needUpdate = true;\n            break;\n\n            // case jsb.EventAssetsManager.ERROR_DECOMPRESS:\n            // console.log('code返回了1！');\n            // break;\n            // case jsb.EventAssetsManager.UPDATE_FAILED:\n            // console.log('code返回了2！');\n            // break;\n            // case jsb.EventAssetsManager.UPDATE_FINISHED:\n            // console.log('code返回了3！');\n            // break;\n            // case jsb.EventAssetsManager.ERROR_UPDATING:\n            // console.log('code返回了4！');\n            // break;\n            // case jsb.EventAssetsManager.ASSET_UPDATED:\n            // console.log('code返回了5！');\n            // break;\n            // case jsb.EventAssetsManager.UPDATE_PROGRESSION:\n            //     console.log('code返回了6！');\n            // break;\n\n            default:\n            console.log('code返回了,但是都没有实现！');\n                return;\n        }\n\n        //下载或者解析manifest失败，重新检查更新\n        if(needRetryCheck) {\n            this.retryCheck();\n            return;\n        }\n\n        //检查完成，移除监听\n        cc.eventManager.removeListener(this._checkListener);\n        this._checkListener = null;\n        this.isUpdating = false;\n\n        //检查是否需要更新，如果不需要则直接开始游戏，否则更新\n        if(needUpdate) {\n            console.log('开始更新');\n            this.hotUpdate();           \n        }\n        else{\n            console.log('直接开始游戏');\n            // this.startGame();\n        }\n    }\n\n    //重新检查更新\n    private retryCheck() {\n        this._am.checkUpdate();\n    }\n\n    // 开始更新\n    private hotUpdate() {\n        //创建并添加更新的回调\n        if(this._am && !this.isUpdating){\n            this._updateListener = new jsb.EventListenerAssetsManager(this._am, this.updateCB.bind(this));\n            cc.eventManager.addListener(this._updateListener, 1);\n        }\n\n        this.isUpdating = true;\n        this._am.update();\n    }\n\n    //处理更新的回调\n    private updateCB(event) {\n        console.log('updateCBCode: ' + event.getEventCode());\n        // 部分文件下载失败\n        let retryUpdate: boolean = false;\n        //下载或者解析manifest失败\n        let failed: boolean = false;\n        //是否重启游戏\n        let needRestart: boolean = false;\n        //是否直接开始游戏\n        let directStart: boolean = false;\n        const code = event.getEventCode();\n        switch(code) {\n            case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:\n            console.log('ERROR_NO_LOCAL_MANIFEST: ' + event.getMessage());\n            console.log('local Manifest未发现, 更新停止.');\n                directStart = true;\n            break;\n\n            case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:\n            console.log('ERROR_DOWNLOAD_MANIFEST: ' + event.getMessage());\n            console.log('下载Manifest失败, 更新停止.');\n                failed = true;\n            break;\n\n            case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:\n            console.log('ERROR_PARSE_MANIFEST: ' + event.getMessage()); \n            console.log('解析Manifest失败, 更新停止.');\n                failed = true;\n            break;\n\n            case jsb.EventAssetsManager.UPDATE_FAILED:\n            console.log('UPDATE_FAILED: ' + event.getMessage());\n            console.log('下载或者解压过程中有失败的资源，更新失败')\n                break;\n\n            case jsb.EventAssetsManager.ERROR_UPDATING:\n            console.log('Asset update error: ' + event.getAssetId() + ', ' + event.getMessage());\n            console.log('下载文件失败');\n                retryUpdate = true;\n                break;\n\n            case jsb.EventAssetsManager.ERROR_DECOMPRESS:\n            console.log('ERROR_DECOMPRESS' + event.getMessage());\n            console.log('解压文件失败');\n                break;\n\n            case jsb.EventAssetsManager.ASSET_UPDATED:\n            console.log('ASSET_UPDATED: ' + event.getAssetId() + ', ' + event.getMessage());\n            console.log('所有文件下载成功')\n                break;\n\n            case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:\n                cc.log('当前版本已是最新, 更新停止.');\n                directStart = true;\n            break;\n\n            case jsb.EventAssetsManager.UPDATE_PROGRESSION:\n                //官网用法\n                // this.panel.byteProgress.progress = event.getPercent();\n                // this.panel.fileProgress.progress = event.getPercentByFile();\n\n                // this.panel.fileLabel.string = event.getDownloadedFiles() + ' / ' + event.getTotalFiles();\n                // this.panel.byteLabel.string = event.getDownloadedBytes() + ' / ' + event.getTotalBytes();\n\n                // var msg = event.getMessage();\n                // if (msg) {\n                //     this.panel.info.string = 'Updated file: ' + msg;\n                //     cc.log(event.getPercent()/100 + '% : ' + msg);\n                // }\n\n                //自定义用法\n                let p = event.getPercent();\n                if (p > 1) {\n                    p = 1;\n                }\n\n                console.log(`正在加载...${Math.floor(100 * p)}%`);  \n                var msg = event.getMessage();\n                if (msg) {\n                    console.log('更新文件：' + msg)\n                }\n                break;\n\n            case jsb.EventAssetsManager.UPDATE_FINISHED:\n            console.log('Update finished. ' + event.getMessage());\n                needRestart = true;\n                break;         \n            \n            default:\n                break;\n        }\n\n        this.isUpdating = false;\n\n        //直接开始游戏\n        if(directStart) {\n            cc.eventManager.removeListener(this._updateListener);\n            this._updateListener = null;\n\n            console.log('直接开始游戏');\n            // this.startGame();\n            return;\n        }\n\n        //下载或者解析manifest失败，重新更新\n        if(failed) {\n            this._am.update();\n            return;\n        }\n\n        //部分文件下载失败，重新下载\n        if(retryUpdate) {\n            this.retryUpdate();\n            return;\n        }\n\n        //更新成功，重启游戏\n        if(needRestart) {\n            cc.eventManager.removeListener(this._updateListener);\n            this._updateListener = null;\n\n            //将热更新的缓存目录添加到搜索路径中，并且前置\n            let searchPaths = jsb.fileUtils.getSearchPaths();\n            let newPath = this._am.getLocalManifest().getSearchPaths();\n\n            console.log('newPaths:' + JSON.stringify(newPath));\n            Array.prototype.unshift(searchPaths, newPath);\n\n            cc.sys.localStorage.setItem('HotUpdateSearchPaths', JSON.stringify(searchPaths));\n            jsb.fileUtils.setSearchPaths(searchPaths);\n\n            cc.audioEngine.stopAll();\n            cc.game.restart();\n        }\n    }\n\n    //重新下载失败的文件\n    private retryUpdate() {\n        console.log('重新下载失败的文件');\n        this._am.downloadFailedAssets();\n    }\n\n    onDestroy() {\n        if(this._checkListener){\n            cc.eventManager.removeListener(this._checkListener);\n            this._checkListener = null;\n        }\n\n        if (this._updateListener) {\n            cc.eventManager.removeListener(this._updateListener);\n            this._updateListener = null;\n        }\n        if (this._am && !cc.sys.ENABLE_GC_FOR_NATIVE_OBJECTS) {\n            this._am.release();\n        }\n    }\n}\n"]}